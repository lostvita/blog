(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{293:function(t,i,e){var n=e(2);n(n.P,"Array",{fill:e(294)}),e(97)("fill")},294:function(t,i,e){"use strict";var n=e(18),o=e(96),a=e(12);t.exports=function(t){for(var i=n(this),e=a(i.length),c=arguments.length,r=o(c>1?arguments[1]:void 0,e),s=c>2?arguments[2]:void 0,l=void 0===s?e:o(s,e);l>r;)i[r++]=t;return i}},295:function(t,i,e){"use strict";e(296);function n(t){this.dur=t,this.easing=function(t){return t}}n.prototype.onFinished=function(){console.log("animation finished")},n.prototype.onProgress=function(t){},n.prototype.start=function(){this.p=0,this.startTime=Date.now();var t=this;requestAnimationFrame(function i(){t.p>=1?(t.onProgress(t.easing(1)),t.onFinished()):(t.p=(Date.now()-t.startTime)/t.dur,t.onProgress(t.easing(t.p)),requestAnimationFrame(i))})},i.a=n},296:function(t,i,e){var n=e(2);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},299:function(t,i,e){},701:function(t,i,e){"use strict";var n=e(299);e.n(n).a},712:function(t,i,e){"use strict";e.r(i);e(293),e(13),e(19),e(100),e(101);var n=e(295),o={filters:{formatTime:function(t){return t>9?"00 : ".concat(t):"00 : 0".concat(t)}},data:function(){return{time:0,tTimer:null,mediaRecord:null,chunks:new Set,videoUrl:null,canRecord:!0,canStop:!1,canDownload:!1,color:["#C04D00","#f5587b","#F75940","#FF2E63","#1794A5","#00a03e"]}},methods:{getPixelRatio:function(t){var i=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/i},initCircleCanvas:function(){var t=this,i=this.$refs.$circle;i.width=600,i.height=300;var e=i.getContext("2d");this.createVideo(i),this.tTimer=new n.a(1e3),this.tTimer.onFinished=function(){t.canStop&&(t.time++,t.tTimer.start())};var o=new n.a(5e3),a=this.color[parseInt(6*Math.random())];o.onProgress=function(i){var n=50*Math.cos(2*i*Math.PI)+300,o=50*Math.sin(2*i*Math.PI)+150;(n<300&&o>150||n>300&&o<150)&&(a=t.color[parseInt(6*Math.random())]),t.drawCircle(e,n,o,a)},o.onFinished=function(){o.start()},o.start()},drawCircle:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,n=arguments.length>3?arguments[3]:void 0,o=20;t.clearRect(0,0,600,300),t.beginPath(),t.arc(i,e,o,0,2*Math.PI,!1),t.lineWidth=0,t.closePath(),t.fillStyle=n,t.fill(),t.strokeStyle=n,t.stroke()},createVideo:function(t){var i=this,e=t.captureStream(10);this.mediaRecord=new MediaRecorder(e,{videoBitsPerSecond:85e5}),this.mediaRecord.ondataavailable=function(t){i.chunks.add(t.data)}},record:function(){this.canRecord=!1,this.canStop=!0,this.canDownload=!1,this.mediaRecord.start(),this.time=0,this.tTimer.start()},stop:function(){var t=this;this.canStop=!1,this.mediaRecord.stop(),setTimeout(function(){t.previewVideo()},2e3)},previewVideo:function(){var t=new Blob(this.chunks,{type:"video/mp4"});this.chunks=new Set,this.videoUrl=window.URL.createObjectURL(t),this.canDownload=!0,this.canRecord=!0},download:function(){var t=document.createElement("a");t.href=this.videoUrl,t.download="record-canvas.mp4",t.style.display="none",document.body.appendChild(t),t.click(),setTimeout(function(){document.body.removeChild(t)},500)}},mounted:function(){this.initCircleCanvas()}},a=(e(701),e(0)),c=Object(a.a)(o,function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"wrapper"},[e("div",{staticClass:"containner"},[e("h3",{staticClass:"title"},[t._v("MediaRecoder录屏效果演示")]),t._v(" "),e("div",{staticClass:"box"},[e("canvas",{ref:"$circle",staticClass:"circle-canvas"}),t._v(" "),e("div",{staticClass:"circle-recording"},[e("span",{staticClass:"circle-point",class:t.canStop?"record":"stop"}),e("span",{staticClass:"circle-time"},[t._v(t._s(t._f("formatTime")(t.time)))])]),t._v(" "),e("div",{staticClass:"circle-ctrl"},[e("button",{staticClass:"circle-btn circle-record",attrs:{disabled:!t.canRecord},on:{click:t.record}},[t._v("Record")]),t._v(" "),e("button",{staticClass:"circle-btn circle-stop",attrs:{disabled:!t.canStop},on:{click:t.stop}},[t._v("Stop")]),t._v(" "),e("button",{staticClass:"circle-btn circle-download",attrs:{disabled:!t.canDownload},on:{click:t.download}},[t._v("Download")])]),t._v(" "),e("div",{staticClass:"circle-preview"},[e("p",{staticClass:"circle-title"},[t._v("预览效果")]),t._v(" "),e("video",{ref:"$video",staticClass:"circle-video",attrs:{src:t.videoUrl,autoplay:"",controls:""}})])])])])},[],!1,null,"0d9225b0",null);i.default=c.exports}}]);